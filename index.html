<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Times to Talk to Nathan</title>
	<link rel="stylesheet" type="text/css" href="style.css" />

	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.3/jquery.mobile.structure-1.4.3.min.css" />
	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.3/jquery.mobile-1.4.3.min.js"></script>
	
</head>

<body>
	<script>
	$(document).ready(function() {
		//initDate();
		$(window).resize();
		$(window).orientationchange();
	});

	function getDate()
	{
		var currentDate = new Date();
		var month = currentDate.getMonth() + 1;
		var day = currentDate.getDay(); // 0=SUN, 1=MON,...

		return day;
	}

	$(window).on("resize", function(event) {
		var c = document.getElementById("schedule");
		c.height = window.innerHeight;
		c.width = window.innerWidth;

		$(window).orientationchange();
	});

	$(window).on("orientationchange", function(event) {
		$("#orientation").text("This device is in "+event.orientation);
		if (event.orientation == "portrait")
		{
			// Portrait mode //
			redrawLayout(0);
		}
		else
		{
			// Landscape mode //
			redrawLayout(1);
		}

	});

	function redrawLayout(orient)
	{
		var c = document.getElementById("schedule");
		var context = c.getContext("2d");

		if (orient == 0)
		{
			context.fillStyle = "#E3E3E3";
			context.fillRect(0, 0, window.innerWidth, window.innerHeight);
		}

		// Draw sidebar time //
      	var tileHeight = (window.innerHeight - 25 - 15) / 11;

      	context.fillStyle = '#919191';
      	context.fillRect(5, 25, 30, window.innerHeight - 25 - 15);
      	context.fillStyle = "#545454";
      	context.fillRect(5, 25, 30, tileHeight);
      	context.fillRect(5, 25+tileHeight*2, 30, tileHeight);
      	context.fillRect(5, 25+tileHeight*4, 30, tileHeight);
      	context.fillRect(5, 25+tileHeight*6, 30, tileHeight);
      	context.fillRect(5, 25+tileHeight*8, 30, tileHeight);
      	context.fillRect(5, 25+tileHeight*10, 30, tileHeight);

		context.beginPath();
		context.rect(5, 25, 30, window.innerHeight - 25 - 15);
      	context.lineWidth = 2;
      	context.strokeStyle = 'black';
      	context.stroke();

      	context.font = "12pt Calibri";
      	context.textAlign = "center";
      	context.fillStyle = "#FFFFFF";
      	context.fillText("8", 20, 25 + 6 + (tileHeight / 2));
      	context.fillText("9", 20, 25 + tileHeight + 6 + (tileHeight / 2));
      	context.fillText("10", 20, 25 + tileHeight*2 + 6 + (tileHeight / 2));
      	context.fillText("11", 20, 25 + tileHeight*3 + 6 + (tileHeight / 2));
      	context.fillText("12", 20, 25 + tileHeight*4 + 6 + (tileHeight / 2));
      	context.fillText("1", 20, 25 + tileHeight*5 + 6 + (tileHeight / 2));
      	context.fillText("2", 20, 25 + tileHeight*6 + 6 + (tileHeight / 2));
      	context.fillText("3", 20, 25 + tileHeight*7 + 6 + (tileHeight / 2));
      	context.fillText("4", 20, 25 + tileHeight*8 + 6 + (tileHeight / 2));
      	context.fillText("5", 20, 25 + tileHeight*9 + 6 + (tileHeight / 2));
      	context.fillText("6", 20, 25 + tileHeight*10 + 6 + (tileHeight / 2));

      	// Horizontal lines //
    	context.lineWidth = 0.25;
    	context.strokeStyle = "#000000";
    	for (l = 0; l < 12; l++)
    	{
    		context.beginPath();
    		context.moveTo(40, 25.5 + tileHeight * l);
    		context.lineTo(window.innerWidth - 5, 25 + tileHeight * l);
    		context.stroke();
    	}
    	/*
    	context.moveTo(40, 25); context.lineTo(window.innerWidth - 5, 25); context.stroke();
    	context.moveTo(40, 25.0 + tileHeight); context.lineTo(window.innerWidth - 5, 25 + tileHeight); context.stroke();
    	context.moveTo(40, 25 + tileHeight*2); context.lineTo(window.innerWidth - 5, 25 + tileHeight*2); context.stroke();
    	context.moveTo(40, 25 + tileHeight*3); context.lineTo(window.innerWidth - 5, 25 + tileHeight*3); context.stroke();
    	context.moveTo(40, 25 + tileHeight*4); context.lineTo(window.innerWidth - 5, 25 + tileHeight*4); context.stroke();
    	context.moveTo(40, 25 + tileHeight*5); context.lineTo(window.innerWidth - 5, 25 + tileHeight*5); context.stroke();
    	context.moveTo(40, 25 + tileHeight*6); context.lineTo(window.innerWidth - 5, 25 + tileHeight*6); context.stroke();
    	context.moveTo(40, 25 + tileHeight*7); context.lineTo(window.innerWidth - 5, 25 + tileHeight*7); context.stroke();
    	context.moveTo(40, 25 + tileHeight*8); context.lineTo(window.innerWidth - 5, 25 + tileHeight*8); context.stroke();
    	context.moveTo(40, 25 + tileHeight*9); context.lineTo(window.innerWidth - 5, 25 + tileHeight*9); context.stroke();
    	context.moveTo(40, 25 + tileHeight*10); context.lineTo(window.innerWidth - 5, 25 + tileHeight*10); context.stroke();
    	context.moveTo(40, 25 + tileHeight*11); context.lineTo(window.innerWidth - 5, 25 + tileHeight*11); context.stroke();
    	*/

    	// Draw schedule boxes //
    	var classes = [["#FF0000", "#00FF00"], ["#0000FF","#0F0F00"]];
    	var times   = [[[10.5, 2],[12.5, 2]],[[10.5,1],[16.5,2]]];
    	//var day = initDate()-1;
    	
		var currentDate = new Date();
		var month = currentDate.getMonth() + 1;
		var day = currentDate.getDay() - 1; // 0=SUN, 1=MON,...
		var hours = currentDate.getHours();
		var minutes = currentDate.getMinutes();
		var offset = currentDate.getTimezoneOffset();

    	if (orient == 0) // Portrait //
    	{
    		var boxWidth = (window.innerWidth - 10 - 30 - 10) / 2;
    		for (d = day; d < classes.length; d++)
    		{
    			for (i = 0; i < classes[d].length; i++)
    			{
    				context.fillStyle = classes[d][i];
    				context.fillRect(40 + (d*boxWidth) + (d*5), 25 + (tileHeight * (times[d][i][0]-8)), boxWidth, (tileHeight * times[d][i][1]));
    			}
    		}
    	}
    	else // Landscape //
    	{
    		var boxWidth = (window.innerWidth - 10 - 30 - 10) / 5;
    		context.fillStyle = "#0000FF";
    		context.fillRect(40, 25, boxWidth, tileHeight*6);
    	}

    	// Draw time line //
    	var hour = (currentDate.getUTCHours() + 10) + (currentDate.getUTCMinutes()/60);
    	//var hour = 8 + (currentDate.getUTCMinutes()/60);
    	var hourVert = 25 + (hour - 8) * tileHeight - (tileHeight/2) + 2;
    	//var hourVert = 200;
    	context.fillText(hourVert, 150, 100);
    	context.beginPath();
    	context.strokeStyle = "#FF0000";
    	context.lineWidth = 4;
    	context.moveTo(40, hourVert+0.5);
    	context.lineTo(window.innerWidth - 5, hourVert+0.5);
    	context.stroke();
	}
	</script>

	<canvas id="schedule" style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%"></canvas>

	<!--
	<div id="wrap">
	<aside class="timeRuler" id="time">
		<ul>
			<li>7</li>
			<li class="darker">8</li>
			<li>9</li>
			<li class="darker">10</li>
			<li>11</li>
			<li class="darker">12</li>
			<li>1</li>
			<li class="darker">2</li>
			<li>3</li>
			<li class="darker">4</li>
			<li>5</li>
			<li class="darker">6</li>
		</ul>
	</aside>

	<div id="columns">
		<div class="col">1</div>
		<div class="col">2</div>
	</div>
	</div>
	-->
</body>

</html>
